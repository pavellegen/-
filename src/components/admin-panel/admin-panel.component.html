<div class="bg-slate-100 dark:bg-slate-950 min-h-screen">
  <header class="bg-white dark:bg-slate-800 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center py-4">
        <h1 class="text-2xl font-bold text-slate-800 dark:text-white">Админ-панель</h1>
        <button (click)="home.emit()" class="text-sm font-semibold text-slate-600 hover:text-amber-600 transition-colors">
          На главный сайт
        </button>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="bg-white dark:bg-slate-800 rounded-lg shadow overflow-hidden">
      <div class="p-4 sm:p-6 border-b border-slate-200 dark:border-slate-700">
        <h2 class="text-lg font-semibold dark:text-white">Список юристов ({{ lawyers().length }})</h2>
      </div>
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-slate-200 dark:divide-slate-700">
          <thead class="bg-slate-50 dark:bg-slate-900">
            <tr>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                ФИО
              </th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                Город
              </th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                Статус
              </th>
              <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                Действия
              </th>
            </tr>
          </thead>
          <tbody class="bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700">
            @for (lawyer of lawyers(); track lawyer.id) {
              <tr>
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="flex items-center">
                    <div class="flex-shrink-0 h-10 w-10">
                      <img class="h-10 w-10 rounded-full object-cover" [src]="lawyer.photoUrl" [alt]="lawyer.fullName">
                    </div>
                    <div class="ml-4">
                      <div class="text-sm font-medium text-slate-900 dark:text-slate-100">{{ lawyer.fullName }}</div>
                      <div class="text-sm text-slate-500 dark:text-slate-400">{{ lawyer.primarySpecialization }}</div>
                    </div>
                  </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-500 dark:text-slate-400">
                  {{ lawyer.city }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  @switch(lawyer.verificationStatus) {
                    @case('approved') {
                      <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-emerald-100 text-emerald-800 dark:bg-emerald-900/70 dark:text-emerald-300">
                        Проверен
                      </span>
                    }
                    @case('pending') {
                       <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/70 dark:text-blue-300">
                        На проверке
                      </span>
                    }
                    @case('rejected') {
                      <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800 dark:bg-red-900/70 dark:text-red-300">
                        Отклонен
                      </span>
                    }
                    @case('none') {
                       <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300">
                        Не подано
                      </span>
                    }
                  }
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2">
                  @if (lawyer.verificationStatus === 'pending') {
                    <button (click)="openVerificationModal(lawyer)" class="text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 transition-colors">Проверить</button>
                  }
                  <button (click)="editLawyer.emit(lawyer)" class="text-amber-600 hover:text-amber-900 dark:text-amber-400 dark:hover:text-amber-300 transition-colors">Редактировать</button>
                  <button (click)="onDelete(lawyer.id)" class="text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 transition-colors">Удалить</button>
                </td>
              </tr>
            } @empty {
                <tr>
                    <td colspan="4" class="text-center py-10 text-slate-500 dark:text-slate-400">
                        В системе пока нет юристов.
                    </td>
                </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  </main>
</div>

@if (isVerificationModalOpen() && lawyerToVerify(); as lawyer) {
  <div class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50" (click)="closeVerificationModal()">
    <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-lg mx-auto" (click)="$event.stopPropagation()">
      <div class="p-6 border-b border-slate-200 dark:border-slate-700">
        <h2 class="text-xl font-bold dark:text-white">Проверка квалификации</h2>
        <p class="text-sm text-slate-500 dark:text-slate-400 mt-1">Юрист: {{ lawyer.fullName }}</p>
      </div>
      <div class="p-6">
        @if(lawyer.verificationInfo; as info) {
          <h3 class="text-base font-semibold text-slate-800 dark:text-slate-200 mb-3">Данные диплома для проверки:</h3>
          <div class="space-y-3 text-sm">
            <div class="p-2 bg-slate-50 dark:bg-slate-900/50 rounded-md">
              <span class="text-slate-500 dark:text-slate-400 block text-xs">Фамилия в дипломе</span>
              <span class="font-medium text-slate-700 dark:text-slate-300">{{ info.lastName }}</span>
            </div>
             <div class="flex gap-4">
                <div class="flex-1 p-2 bg-slate-50 dark:bg-slate-900/50 rounded-md">
                  <span class="text-slate-500 dark:text-slate-400 block text-xs">Серия / Номер бланка</span>
                  <span class="font-mono text-slate-700 dark:text-slate-300">{{ info.series }} / {{ info.number }}</span>
                </div>
                 <div class="flex-1 p-2 bg-slate-50 dark:bg-slate-900/50 rounded-md">
                  <span class="text-slate-500 dark:text-slate-400 block text-xs">Дата выдачи</span>
                  <span class="font-medium text-slate-700 dark:text-slate-300">{{ info.issueDate | date:'dd.MM.yyyy' }}</span>
                </div>
             </div>
          </div>
        } @else {
           <p class="text-slate-500 dark:text-slate-400">Информация для верификации не предоставлена.</p>
        }

        @if(isRejectionInputVisible()) {
          <div class="mt-6 animate-fade-in">
            <label for="rejection-reason" class="block text-sm font-medium text-slate-700 dark:text-slate-300">Причина отклонения</label>
            <textarea id="rejection-reason" [value]="rejectionReason()" (input)="rejectionReason.set($event.target.value)" rows="3" class="mt-1 block w-full rounded-md border-slate-300 dark:border-slate-600 dark:bg-slate-900 dark:text-slate-200 shadow-sm focus:border-red-500 focus:ring-red-500" placeholder="Например: нечеткие данные, серия и номер не найдены в реестре..."></textarea>
          </div>
        }
      </div>
      <div class="p-4 bg-slate-50 dark:bg-slate-900/50 rounded-b-2xl flex justify-between items-center">
        <button type="button" (click)="closeVerificationModal()" class="px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md hover:bg-slate-50 dark:bg-slate-600 dark:text-white dark:border-slate-500 dark:hover:bg-slate-500 transition">Закрыть</button>
        
        @if(isRejectionInputVisible()) {
           <div class="flex items-center gap-3">
             <button type="button" (click)="isRejectionInputVisible.set(false)" class="px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md hover:bg-slate-50 dark:bg-slate-600 dark:text-white dark:border-slate-500 dark:hover:bg-slate-500 transition">Назад</button>
             <button type="button" (click)="rejectVerification()" [disabled]="!rejectionReason().trim()" class="px-5 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 disabled:bg-slate-400 transition">Отклонить</button>
           </div>
        } @else {
          <div class="flex items-center gap-3">
            <button type="button" (click)="isRejectionInputVisible.set(true)" class="px-5 py-2 text-sm font-medium text-red-700 bg-red-100 border border-transparent rounded-md hover:bg-red-200 dark:bg-red-900/50 dark:text-red-300 dark:hover:bg-red-900 transition">Отклонить</button>
            <button type="button" (click)="approveVerification()" class="px-5 py-2 text-sm font-medium text-white bg-emerald-600 rounded-md hover:bg-emerald-700 transition">Одобрить</button>
          </div>
        }
      </div>
    </div>
  </div>
}
<style>
  .animate-fade-in {
    animation: fadeIn 0.5s ease-in-out;
  }
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
</style>

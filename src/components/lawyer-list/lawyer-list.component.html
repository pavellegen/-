<div class="bg-slate-100 dark:bg-slate-950 min-h-screen">
  <div class="container mx-auto px-6 py-12">
    <div class="mb-8">
       <button (click)="onBack()" class="flex items-center text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white font-semibold transition-colors">
         <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5 mr-2">
           <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" />
         </svg>
        Назад к категориям
       </button>
       <div class="flex flex-col md:flex-row md:items-center md:justify-between mt-4 gap-4">
         <h1 class="text-4xl font-bold dark:text-white">Юристы по направлению: {{ category() }}</h1>
         <button (click)="showFilters.set(!showFilters())" class="relative flex-shrink-0 flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-800 text-white ring-2 ring-amber-500 hover:bg-slate-700 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z" />
            </svg>
            <span>Фильтры</span>
            @if(areFiltersActive()) {
              <span class="absolute -top-1 -right-1 block h-3 w-3 rounded-full bg-emerald-500 ring-2 ring-slate-100 dark:ring-slate-950"></span>
            }
         </button>
       </div>
       
       <div [hidden]="!showFilters()" class="mt-4 p-4 rounded-lg bg-white dark:bg-slate-800 shadow-lg animate-fade-in-down">
         <div class="flex items-center gap-2 flex-wrap justify-start md:justify-end">
           <button (click)="toggleFavoritesFilter()" [title]="showOnlyFavorites() ? 'Показать всех' : 'Показать только избранных'" class="flex-shrink-0 p-3 rounded-lg ring-2 transition-colors duration-300"
            [class.ring-amber-500]="showOnlyFavorites()"
            [class.bg-amber-500]="showOnlyFavorites()"
            [class.text-white]="showOnlyFavorites()"
            [class.ring-slate-700]="!showOnlyFavorites()"
            [class.bg-slate-800]="!showOnlyFavorites()"
            [class.text-slate-400]="!showOnlyFavorites()"
            [class.hover:text-white]="!showOnlyFavorites()">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
                <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.006Z" clip-rule="evenodd" />
              </svg>
            </button>
            <button (click)="toggleFreeConsultationFilter()" [title]="showOnlyFreeConsultation() ? 'Показать всех' : 'Только с бесплатной консультацией'" class="flex-shrink-0 p-3 rounded-lg ring-2 transition-colors duration-300"
              [class.ring-emerald-500]="showOnlyFreeConsultation()"
              [class.bg-emerald-500]="showOnlyFreeConsultation()"
              [class.text-white]="showOnlyFreeConsultation()"
              [class.ring-slate-700]="!showOnlyFreeConsultation()"
              [class.bg-slate-800]="!showOnlyFreeConsultation()"
              [class.text-slate-400]="!showOnlyFreeConsultation()"
              [class.hover:text-white]="!showOnlyFreeConsultation()">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M10 5v14m-3-9h5m-5-4h6a4 4 0 0 1 0 8h-6M5 19L19 5" />
              </svg>
            </button>
           @if(availableCities().length > 1) {
             <div class="relative">
              <label for="city-filter" class="sr-only">Фильтр по городу</label>
              <select id="city-filter"
                [value]="selectedCity()"
                (change)="onCityChange($event)"
                class="appearance-none w-full md:w-auto pl-4 pr-10 py-3 rounded-lg bg-slate-800 text-white ring-2 ring-amber-500 focus:outline-none transition-all duration-300 cursor-pointer">
                <option value="all">Все города</option>
                @for (city of availableCities(); track city) {
                  <option [value]="city">{{ city }}</option>
                }
              </select>
              <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                  <svg class="h-5 w-5 text-slate-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
                  </svg>
              </div>
             </div>
           }

           <div class="relative w-full md:w-auto">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <svg class="h-5 w-5 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
              </div>
              <input 
                type="search" 
                placeholder="Поиск по имени, навыкам..."
                [value]="searchQuery()"
                (input)="onSearchInput($event)"
                class="w-full md:w-80 pl-10 pr-10 py-3 rounded-lg bg-slate-800 text-white placeholder:text-slate-400 ring-2 ring-amber-500 focus:outline-none transition-all duration-300">
              @if (searchQuery()) {
                <button (click)="clearSearch()" type="button" class="absolute inset-y-0 right-0 pr-3 flex items-center group">
                    <div class="bg-slate-600 group-hover:bg-slate-500 rounded-full p-0.5 transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4 text-slate-300">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                        </svg>
                    </div>
                </button>
              }
           </div>
         </div>
       </div>
    </div>

    @if (allLawyersInCategory().length > 0) {
      @if (filteredLawyers().length > 0) {
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          @for (lawyer of paginatedLawyers(); track lawyer.id) {
            <app-lawyer-card [lawyer]="lawyer" (click)="onSelectLawyer(lawyer)"></app-lawyer-card>
          }
        </div>

        @if (totalPages() > 1) {
          <div class="mt-12 flex flex-col sm:flex-row items-center justify-between gap-4">
            <div>
              <p class="text-sm text-slate-700 dark:text-slate-400">
                {{ paginationSummary() }}
              </p>
            </div>
            <div class="flex items-center gap-2">
              <button (click)="prevPage()" [disabled]="currentPage() === 1" class="px-4 py-2 text-sm font-medium rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 border border-slate-300 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700">
                Назад
              </button>
              <span class="text-sm font-semibold text-slate-700 dark:text-slate-200 px-2">
                Стр. {{ currentPage() }} / {{ totalPages() }}
              </span>
              <button (click)="nextPage()" [disabled]="currentPage() === totalPages()" class="px-4 py-2 text-sm font-medium rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 border border-slate-300 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700">
                Далее
              </button>
            </div>
          </div>
        }
      } @else {
        @if(showOnlyFavorites()) {
           <div class="text-center py-16 bg-white dark:bg-slate-800 rounded-lg shadow">
              <h2 class="text-2xl font-semibold mb-2 dark:text-white">Нет избранных юристов</h2>
              <p class="text-slate-600 dark:text-slate-400">Вы еще не добавили юристов в избранное в этой категории.<br>Нажмите на ⭐ на карточке юриста, чтобы добавить его сюда.</p>
            </div>
        } @else if (showOnlyFreeConsultation()) {
            <div class="text-center py-16 bg-white dark:bg-slate-800 rounded-lg shadow">
              <h2 class="text-2xl font-semibold mb-2 dark:text-white">Нет юристов с бесплатной консультацией</h2>
              <p class="text-slate-600 dark:text-slate-400">В данной категории нет юристов, предлагающих бесплатную первую консультацию.</p>
            </div>
        } @else {
          <div class="text-center py-16 bg-white dark:bg-slate-800 rounded-lg shadow">
            <h2 class="text-2xl font-semibold mb-2 dark:text-white">Ничего не найдено</h2>
            <p class="text-slate-600 dark:text-slate-400">По вашему запросу "{{ searchQuery() }}" юристы не найдены. Попробуйте изменить поисковый запрос.</p>
          </div>
        }
      }
    } @else {
      <div class="text-center py-16 bg-white dark:bg-slate-800 rounded-lg shadow">
        <h2 class="text-2xl font-semibold mb-2 dark:text-white">Специалисты не найдены</h2>
        <p class="text-slate-600 dark:text-slate-400">К сожалению, по этой категории пока нет юристов. Попробуйте выбрать другую.</p>
      </div>
    }
  </div>
</div>
<style>
  .animate-fade-in-down {
    animation: fadeInDown 0.3s ease-in-out;
  }
  @keyframes fadeInDown {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>